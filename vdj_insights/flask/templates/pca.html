{% extends "sharedTemplates/base.html" %}
{% block title %}PCA{% endblock %}
{% block body %}
    <div class="container">
        <div class="collapse" id="collapse_info">
            <div id="infoBox" class="card mt-3 shadow">
                <button
                        type="button"
                        class="btn p-0 position-absolute"
                        style="top: 0.5rem; right: 0.5rem; color: #6c757d; font-size: 1.25rem; line-height: 1;"
                        data-toggle="collapse"
                        data-target="#collapse_info"
                        aria-label="Close"
                >
                    &times;
                </button>
                <div class="card-body">
                    <h5 class="card-title">Principal component analysis</h5>
                    <p class="card-text">
                          <p>
    Principal component analysis (PCA) is a technique that reduces high-dimensional data into a few summary dimensions
    (called principal components) that capture the greatest variance in your measurements. We standardize each feature
    (so they all have mean 0 and unit variance), compute the covariance matrix, find its eigenvectors (the directions
    of maximal variance), and project the data onto the top two eigenvectors to get PC1 and PC2.
  </p>
  <p>
    On this page, PCA is performed on an <strong>allele basis</strong>â€”meaning each individual allele count
    across all targets is treated as a separate feature. Because alleles vary more finely than broader categories
    like subfamilies, this allele-level PCA tends to spread samples farther apart in the plot. If you instead grouped
    by subfamily (combining several alleles into one feature), the points would generally cluster more tightly,
    showing less separation between samples.
  </p>
  <p>
    Hover over any point to see its <em>Sample</em> name and <em>Population</em> (if available). Use the dropdown
    at the top to filter by <strong>Region</strong>.
  </p>
                    </p>
                </div>
            </div>
        </div>

        <div class="d-flex justify-content-between align-items-center mt-5">
            <h2 class="mt-0">PCA</h2>
            <a class="btn gap-2" data-toggle="collapse" href="#collapse_info" role="button">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor"
                     class="bi bi-info-circle" viewBox="0 0 16 16">
                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
                    <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/>
                </svg>
            </a>
        </div>

        {% for region, pca_div in pca_divs.items() %}
    <section>
              <h2>{{ region }}</h2>

        <div class="card card-body mb-4 shadow">
            {{ pca_div|safe }}
        </div>
    </section>
  {% endfor %}


{% endblock %}
